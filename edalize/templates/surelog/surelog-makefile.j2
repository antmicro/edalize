#Auto generated by Edalize

VERILOG       := {{ sources }}
SYSTEMVERILOG := {{ sv_sources }}
TOP           := {{ top }}

{% if arch == 'ecp5' -%}
LIBRARY_COMMAND := -v $(shell $(EDALIZE_LAUNCHER) yosys-config --datdir)/{{ arch }}/cells_bb.v
{% elif arch == "ice40" %}
LIBRARY_COMMAND := -v $(shell $(EDALIZE_LAUNCHER) yosys-config --datdir)/{{ arch }}/cells_sim.v
{% else %}
LIBRARY_COMMAND := -v $(shell $(EDALIZE_LAUNCHER) yosys-config --datdir)/{{ arch }}/cells_xtra_surelog.v -v $(shell $(EDALIZE_LAUNCHER) yosys-config --datdir)/{{ arch }}/cells_sim.v
{%- endif %}

{% if verilog_params_command -%}
PARAMS_COMMAND = {{ verilog_params_command }}
{%- endif %}

{% if verilog_params_command -%}
DEFINES_COMMAND = {{ verilog_defines_command }}
{%- endif %}

{% if include_files_command -%}
INCLUDE_COMMAND = {{ include_files_command }}
{%- endif %}

{% if surelog_options -%}
SURELOG_OPTIONS = {{ surelog_options }}
{%- endif %}

all: ${TOP}.uhdm

${TOP}.uhdm:
	$(EDALIZE_LAUNCHER) surelog ${SURELOG_OPTIONS} -parse ${LIBRARY_COMMAND} ${DEFINES_COMMAND} ${PARAMS_COMMAND} -top ${TOP} ${INCLUDE_COMMAND} ${VERILOG} ${SYSTEMVERILOG}
	cp slpp_all/surelog.uhdm ${TOP}.uhdm
