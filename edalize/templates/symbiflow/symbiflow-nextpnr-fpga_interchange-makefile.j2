#Auto generated by Edalize
SHELL = bash

NAME	:= {{ top }}
PARTNAME:= {{ partname }}
BITSTREAM_DEVICE := {{ bitstream_device }}
BUILDDIR:= {{ builddir }}

all: ${NAME}.bit

{% if environment_script -%}
SOURCE_OPTS = source {{ environment_script }} &&
{%- endif %}

${BUILDDIR}:
	mkdir ${BUILDDIR}

${NAME}.fasm: ${NAME}-nextpnr.mk | ${BUILDDIR}
	${SOURCE_OPTS} $(MAKE) -f ${NAME}-nextpnr.mk

${NAME}.bit: ${NAME}.fasm
	${SOURCE_OPTS} cd ${BUILDDIR} && symbiflow_write_bitstream -d ${BITSTREAM_DEVICE} -f ${NAME}.fasm -p ${PARTNAME} -b ${NAME}.bit

clean:
	rm -rf ${BUILDDIR}

